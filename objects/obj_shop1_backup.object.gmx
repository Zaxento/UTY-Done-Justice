<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>murder = 0
if (scr_murderlv() &gt;= 7)
    murder = 1
instance_create(0, 0, obj_fader)
vol = 0.8
if (global.flag[7] == 0)
{
    shopmus = mus_shop
    caster_loop(shopmus, vol, 0.93)
    if (murder == 1)
        audio_sound_pitch(shopmus, 0.2)
}
menumax = 3
menu = 0
menuc[0] = 0
menuc[1] = 0
menuc[2] = 0
menuc[3] = 0
menuc[4] = 0
item0pic = spr_heartyellow
item1pic = spr_heartyellow
item2pic = spr_heartyellow
item3pic = spr_heartyellow
item[0] = 14
item[1] = 15
item[2] = 19
item[3] = 21
sell = 0
bought = 0
mainmessage = 0
itemcost[0] = 50
itemcost[1] = 50
itemcost[2] = 15
if (global.plot &gt; 100)
    itemcost[2] = 30
if (global.plot &gt; 121)
    itemcost[2] = 45
if (global.plot &gt; 199)
    itemcost[2] = 70
itemcost[3] = 25
if (murder == 1)
{
    itemcost[0] = 0
    itemcost[1] = 0
    itemcost[2] = 0
    itemcost[3] = 0
}
minimenuy = 120
global.typer = 23
scr_setfont(fnt_maintext)
sidemessage = 0
selling = 0
global.msc = 0
glow = 0
shx = 130
instance_create((18 + shx), 40, obj_shopeyes1)
soldo = 0
global.faceemotion = 0
an = 0
facespr[1] = spr_shopkeeper1_face1
facespr[2] = spr_shopkeeper1_face2
facespr[3] = spr_shopkeeper1_face3
facespr[4] = spr_shopkeeper1_face4
facespr[5] = spr_shopkeeper1_face5
facespr[6] = spr_shopkeeper1_face6
if (murder == 1)
{
    with (obj_shopeyes1)
        instance_destroy()
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (global.flag[7] == 0)
    audio_stop_sound(shopmus)
instance_create(0, 0, obj_persistentfader)
room_goto(room_tundra_town)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (global.flag[7] == 0)
{
    audio_sound_gain(shopmus, vol, 0)
    vol -= 0.02
    alarm[2] = 1
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>instance_create(0, 0, obj_unfader)
alarm[2] = 1
alarm[3] = 40
global.entrance = 18
global.interact = 3
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var wdiff, adiff, wdiffs, adiffs, i, cost, hearty, heartx, textx, writerx, writer;
glow += 2
glow2 = ((floor((sin((glow / 30)) * 2)) / 32) + 0.125)
draw_sprite(spr_shop1_bg, 0, 0, 0)
draw_sprite_ext(spr_shop1_bgorange, 0, 0, 0, 1, 1, 0, c_white, glow2)
if (murder == 0)
    draw_sprite(spr_shopkeeper1, 0, shx, 0)
if (menu == 1 || menu == 2)
{
    wdiff = (5 - global.wstrength)
    adiff = (7 - global.adef)
    wdiffs = string(wdiff)
    if (wdiff &gt;= 0)
        wdiffs = ("+" + wdiffs)
    adiffs = string(adiff)
    if (adiff &gt;= 0)
        adiffs = ("+" + adiffs)
    if (menuc[1] &gt;= 0 &amp;&amp; menuc[1] &lt;= 3)
        scr_shop_draw_infobox(minimenuy, scr_gettext(("shop1_itemdesc_" + string(item[menuc[1]])), wdiffs, adiffs))
}
scr_shop_draw_window(menu &lt; 4)
draw_set_color(c_white)
if (menu == 0)
{
    sell = 0
    selling = 0
    sidemessage = 0
    menuc[1] = 0
    menuc[2] = 0
    menuc[3] = 0
    menuc[4] = 0
    if (instance_exists(OBJ_WRITER) == 0)
    {
        global.msg[0] = scr_gettext("obj_shop1_263") // \E0* Take your time./*
        if (mainmessage == 0)
            global.msg[0] = scr_gettext("obj_shop1_264") // \E0* Hello^1, traveller^1.&amp;* How can I help you?/*
        mainmessage = 1
        if (murder == 1)
            global.msg[0] = scr_gettext("obj_shop1_265") // * But nobody came./*
        instance_create(0, 110, OBJ_WRITER)
    }
    else if control_check_pressed(1)
    {
        with (OBJ_WRITER)
        {
            if (halt == false)
                stringpos = string_length(originalstring)
            control_clear(1)
        }
    }
    menumax = 3
    scr_shop_draw_topmenu(murder != 0)
    if control_check_pressed(0)
    {
        OBJ_WRITER.dfy = 1
        control_clear(0)
        if (menuc[0] == 0)
            menu = 1
        if (menuc[0] == 1)
        {
            sell = 1
            menu = 4
        }
        if (menuc[0] == 2)
        {
            if (murder == 0)
                menu = 3
            else
            {
                menu = 4
                sell = 7
            }
        }
        if (menuc[0] == 3)
        {
            sell = 2
            menu = 4
        }
    }
}
if (menu == 1 || menu == 2)
{
    for (i = 0; i &lt; 4; i++)
    {
        if (murder == 1)
            cost = "00"
        else
            cost = string(itemcost[i])
        draw_text(30, (130 + (20 * i)), scr_gettext("shop_buy_list", cost, scr_gettext(("item_name_" + string(item[i])))))
    }
    draw_text(30, 210, scr_gettext("shop_exit_submenu")) // Exit
    if (menu == 1)
    {
        menumax = 4
        if (instance_exists(OBJ_WRITER) == 0)
        {
            if (sidemessage == 0)
                global.msg[0] = scr_gettext("obj_shop1_352") // \E0What would&amp;you like&amp;to buy?/*
            if (sidemessage == 1)
                global.msg[0] = scr_gettext("obj_shop1_353") // \E5Thanks for&amp;your&amp;purchase./*
            if (sidemessage == 2)
                global.msg[0] = scr_gettext("obj_shop1_354") // \E0Just&amp;looking?/*
            if (sidemessage == 3)
                global.msg[0] = scr_gettext("obj_shop1_355") // \E6That's not&amp;enough&amp;money./*
            if (sidemessage == 4)
                global.msg[0] = scr_gettext("obj_shop1_356") // \E6You're&amp;carrying&amp;too much./*
            if (murder == 1)
                global.msg[0] = scr_gettext("obj_shop1_357") // /*
            instance_create(210, 110, OBJ_WRITER)
        }
        hearty = 134
        if (global.language == "ja")
            hearty -= 2
        draw_sprite(spr_heartsmall, 0, 15, (hearty + (menuc[1] * 20)))
        if control_check_pressed(0)
        {
            menu = 2
            OBJ_WRITER.dfy = 1
            if (menuc[1] == menumax)
                menu = 0
        }
        else if control_check_pressed(1)
        {
            menu = 0
            OBJ_WRITER.dfy = 1
        }
        if (menu == 2)
            control_clear(0)
        menuc[2] = 0
    }
    if (menu == 2)
    {
        heartx = (scr_shop_divider_pos() + 15)
        textx = (heartx + 5)
        if (global.language == "ja")
            textx -= 8
        menumax = 1
        if (murder == 0)
        {
            draw_text(textx, 130, scr_gettext("shop_buy_prompt1", string(itemcost[menuc[1]])))
            draw_text(textx, 145, scr_gettext("shop_buy_prompt2", string(itemcost[menuc[1]])))
        }
        if (murder == 1)
            draw_text(textx, 130, scr_gettext("shop_take_prompt")) // Take it.
        draw_text((heartx + 15), 170, scr_gettext("yes")) // Yes
        draw_text((heartx + 15), 185, scr_gettext("no")) // No
        hearty = 174
        if (global.language == "ja")
            hearty -= 2
        draw_sprite(spr_heartsmall, 0, heartx, (hearty + (menuc[2] * 15)))
        if control_check_pressed(1)
        {
            menu = 1
            control_clear(1)
            sidemessage = 2
        }
        else if control_check_pressed(0)
        {
            control_clear(0)
            if (menuc[2] == 0)
            {
                scr_cost(itemcost[menuc[1]])
                if (afford == 1)
                {
                    script_execute(scr_itemget, item[menuc[1]])
                    if (noroom == 0)
                    {
                        global.gold -= itemcost[menuc[1]]
                        sidemessage = 1
                        audio_play_sound(snd_buyitem, 80, false)
                    }
                    if (noroom == 1)
                        sidemessage = 4
                }
                else
                    sidemessage = 3
            }
            if (menuc[2] == 1)
                sidemessage = 2
            menu = 1
        }
    }
    if (menuc[1] != 4)
    {
        if (minimenuy &gt; (120 - scr_shop_infobox_height(0)))
            minimenuy -= 3
        if (minimenuy &gt; 55)
            minimenuy -= 2
        if (minimenuy &gt; 80)
            minimenuy -= 4
        if (minimenuy &gt; 100)
            minimenuy -= 5
    }
    else if (minimenuy &lt; 120)
        minimenuy += 20
}
if (menu == 3)
{
    menumax = 4
    if (global.flag[7] == 0)
    {
        scr_shop_draw_talktitle(0, 0, scr_gettext("shop1_talk1_title")) // Say hello
        scr_shop_draw_talktitle(1, 0, scr_gettext("shop1_talk2_title")) // What to do here
        scr_shop_draw_talktitle(2, 0, scr_gettext("shop1_talk3_title")) // Town history
        scr_shop_draw_talktitle(3, 0, scr_gettext("shop1_talk4_title")) // Your life
    }
    else
    {
        scr_shop_draw_talktitle(0, 0, scr_gettext("shop1_talk5_title")) // What happened
        scr_shop_draw_talktitle(1, 0, scr_gettext("shop1_talk6_title")) // Human
        scr_shop_draw_talktitle(2, 0, scr_gettext("shop1_talk7_title")) // Ruins
        scr_shop_draw_talktitle(3, 0, scr_gettext("shop1_talk8_title")) // Future
    }
    scr_shop_draw_talkmenu()
    if (instance_exists(OBJ_WRITER) == 0)
    {
        global.msg[0] = scr_gettext("obj_shop1_438") // \E0Care to&amp;chat?/*
        writerx = 210
        if (global.language == "ja")
            writerx += 2
        writer = instance_create(writerx, 110, OBJ_WRITER)
    }
    if control_check_pressed(0)
    {
        OBJ_WRITER.dfy = 1
        if (menuc[3] &lt; menumax)
        {
            sell = (menuc[3] + 3)
            control_clear(0)
            menu = 4
        }
        else
            menu = 0
    }
    else if control_check_pressed(1)
    {
        control_clear(1)
        menu = 0
        OBJ_WRITER.dfy = 1
    }
}
if (menu &lt; 4)
    scr_shop_draw_status()
if (menu == 4)
{
    if (sell == 0)
        menu = 0
    if (instance_exists(OBJ_WRITER) == 0 &amp;&amp; selling == 0)
    {
        if (sell == 1)
        {
            global.msg[0] = scr_gettext("obj_shop1_476") // \E3* Huh^1?&amp;* Sell somethin'^1?&amp;* Does this look like a&amp;  pawn shop?/
            global.msg[1] = scr_gettext("obj_shop1_477") // \E4* I don't know how it works where&amp;  you come from... but.../
            global.msg[2] = scr_gettext("obj_shop1_478") // \E0* If I started spending money&amp;  on old branches and used&amp;  bandages^1, I'd be out of business&amp;  in a jiffy!/%%
            soldo += 1
            if (soldo &gt; 1)
            {
                global.msg[0] = scr_gettext("obj_shop1_480") // \E4* If you're really hurtin' for&amp;  cash^1, then maybe you could&amp;  do some crowdfunding./
                global.msg[1] = scr_gettext("obj_shop1_481") // * I hear people will pay for&amp;  ANYTHING nowadays./%%
            }
            if (murder == 1)
            {
                if (global.flag[255] == 0)
                {
                    global.msg[0] = scr_gettext("obj_shop1_486") // * You took 758G from behind the&amp;  counter./%%
                    global.gold += 758
                    global.flag[255] = 1
                }
                else
                    global.msg[0] = scr_gettext("obj_shop1_492") // * Nothing left./%%
            }
        }
        if (sell == 2)
        {
            global.msg[0] = scr_gettext("obj_shop1_498") // \E0* Bye now^1!&amp;* Come again sometime!/%%
            if (murder == 1)
                global.msg[0] = scr_gettext("obj_shop1_500") // * .../%%
        }
        if (sell == 3)
        {
            global.msg[0] = scr_gettext("obj_shop1_504") // \E0* Hiya^1! Welcome to Snowdin^1!&amp;* I can't remember the last&amp;  time I saw a fresh face around&amp;  here./
            global.msg[1] = scr_gettext("obj_shop1_505") // \E4* Where did you come from^1?&amp;* The capital?/
            global.msg[2] = scr_gettext("obj_shop1_506") // \E0* You don't look like a tourist^1.&amp;* Are you here by yourself?/%%
            if (global.flag[7] == 1)
            {
                global.msg[0] = scr_gettext("obj_shop1_511") // \E0* I mean^1, it happened to you^1,&amp;  right?/
                global.msg[1] = scr_gettext("obj_shop1_512") // * There was a strange flash of&amp;  white light..^1.&amp;* Then I felt my body being pulled&amp;  into..^1. something./
                global.msg[2] = scr_gettext("obj_shop1_513") // * Then^1, suddenly^1, everything was&amp;  back to normal./%%
            }
        }
        if (sell == 4)
        {
            global.msg[0] = scr_gettext("obj_shop1_518") // \E0* You want to know what to do&amp;  here in Snowdin?/
            global.msg[1] = scr_gettext("obj_shop1_519") // \E4* Grillby's has food^1, and the&amp;  library has information.../
            global.msg[2] = scr_gettext("obj_shop1_520") // * If you're tired^1, you can take&amp;  a nap at the inn^1.&amp;* It's right next door ^1- my sister&amp;  runs it./
            global.msg[3] = scr_gettext("obj_shop1_521") // \E0* And if you're bored^1, you can&amp;  sit outside and watch those wacky&amp;  skeletons do their thing./
            global.msg[4] = scr_gettext("obj_shop1_522") // \E0* There's two of 'em..^1.&amp;*\E4 Brothers^1, I think^1.&amp;* They just showed up one day&amp;  and..^1.&amp;*\E0 ... asserted themselves./
            global.msg[5] = scr_gettext("obj_shop1_523") // * The town has gotten a lot&amp;  more interesting since then./%%
            if (global.flag[7] == 1)
            {
                global.msg[0] = scr_gettext("obj_shop1_528") // \E0* I heard that it was all 'cause&amp;  a human came through here./
                global.msg[1] = scr_gettext("obj_shop1_529") // * A human..^1.&amp;* I can hardly believe it!/
                global.msg[2] = scr_gettext("obj_shop1_530") // * Well if they decide to stop&amp;  in^1, I'll be sure to give&amp;  them a hero's welcome./%%
            }
        }
        if (sell == 5)
        {
            global.msg[0] = scr_gettext("obj_shop1_536") // \E4* Think back to your history&amp;  class.../
            global.msg[1] = scr_gettext("obj_shop1_537") // \E0* A long time ago^1, monsters lived&amp;  in the RUINS back there in&amp;  the forest./
            global.msg[2] = scr_gettext("obj_shop1_538") // * Long story short^1, we all decided&amp;  to leave the ruins and head&amp;  for the end of the caverns./
            global.msg[3] = scr_gettext("obj_shop1_539") // * Along the way^1, some fuzzy folk&amp;  decided they liked the cold&amp;  and set up camp in Snowdin./
            global.msg[4] = scr_gettext("obj_shop1_540") // \E6* Oh^1, and don't think about&amp;  trying to explore the RUINS.../
            global.msg[5] = scr_gettext("obj_shop1_541") // \E0* The door's been locked for&amp;  ages^1.&amp;* So unless you're a ghost&amp;  or can burrow under the door^1,&amp;  forget about it./%%
            if (global.flag[7] == 1)
            {
                global.msg[0] = scr_gettext("obj_shop1_545") // \E0* Didja hear^1?&amp;* The RUINS have been opened up^1,&amp;  and get this.../
                global.msg[1] = scr_gettext("obj_shop1_546") // * They were opened from the&amp;  INSIDE./
                global.msg[2] = scr_gettext("obj_shop1_547") // * Apparently the Queen had been&amp;  staying inside there for God&amp;  knows how long./
                global.msg[3] = scr_gettext("obj_shop1_548") // * Pretty unbelievable^1, huh!?/%%
            }
        }
        if (sell == 6)
        {
            global.msg[0] = scr_gettext("obj_shop1_555") // \E0* Life is the same as usual./
            global.msg[1] = scr_gettext("obj_shop1_556") // \E1* A little claustrophobic.../
            global.msg[2] = scr_gettext("obj_shop1_557") // \E2* But..^1. we all know deep down&amp;  that freedom is coming^1, don't we?/
            global.msg[3] = scr_gettext("obj_shop1_558") // \E2* As long as we got that hope^1, we&amp;  can grit our teeth and face the&amp;  same struggles^1, day after day.../
            global.msg[4] = scr_gettext("obj_shop1_559") // \E5* That's life^1, ain't it?/%%
            if (global.flag[7] == 1)
            {
                global.msg[0] = scr_gettext("obj_shop1_563") // \E0* Well^1, I suppose I'll move&amp;  my store to the overworld.../
                global.msg[1] = scr_gettext("obj_shop1_564") // * ... haven't planned much&amp;  more than that^1, I'm afraid./%%
            }
        }
        if (sell == 7)
        {
            global.msg[0] = scr_gettext("obj_shop1_570") // * (There's a note here.)/
            global.msg[1] = scr_gettext("obj_shop1_571") // * Please don't hurt my family./%%
        }
        instance_create(10, 110, OBJ_WRITER)
        selling = 1
    }
    if instance_exists(OBJ_WRITER)
    {
        if control_check_pressed(1)
        {
            with (OBJ_WRITER)
            {
                if (halt == false)
                    stringpos = string_length(originalstring)
                control_clear(1)
            }
        }
    }
    if (selling == 1 &amp;&amp; instance_exists(OBJ_WRITER) == 0)
    {
        if (sell == 2)
        {
            selling = 2
            event_user(1)
        }
        else
        {
            if (sell == 1 || sell == 7)
                menu = 0
            else
                menu = 3
            sell = 0
            selling = 0
        }
    }
}
if keyboard_check_pressed(vk_down)
{
    menuc[menu] += 1
    if (menuc[menu] &gt; menumax)
        menuc[menu] = 0
}
if keyboard_check_pressed(vk_up)
{
    menuc[menu] -= 1
    if (menuc[menu] &lt; 0)
        menuc[menu] = menumax
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
